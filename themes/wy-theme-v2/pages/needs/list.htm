title = '需求'
url = '/needs/category/:slug?'
layout= 'default'

==
function onEnd(){

if($this->param('slug')){
$this['needs']=\Buuug7\User\Models\Need::displayByCategory($this->param('slug'));
$this->page->title='服务市场 | '.\Buuug7\User\Models\Need::getCategories()[$this->param('slug')];
}else{
$this['needs']=\Buuug7\User\Models\Need::displayChecked();
}

//var_dump($this->needs->count());

}
==

<section class="box fwsc-list " style="margin-bottom: 30px">
    <div class="hd"><i>{{ this.page.title }}</i></div>
    <div class="dd" style="height: auto;">
        <ul>
            {% for need in needs %}
            <li>
                <a href="/needs/need/{{ need.id }}" target="_blank">
                    <span>{{ need.title }}</span>
                </a>
                <span class="time">{{ need.checked_at|time_diff }}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
    <div style="margin-left: 45px;">
        {{ needs.render|raw }}
    </div>
</section>
